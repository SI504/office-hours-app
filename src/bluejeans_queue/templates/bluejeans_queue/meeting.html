{% extends "base.html" %}

{% block content %}
<p>Welcome to <strong>{{ owner.get_full_name }}'s</strong> meeting queue.</p>
  {% if not meeting %}
  <ul>
  <li>Number of people currently in line: <strong>{{ queue_length }}</strong></li>
  <li>You are in not in line</li>
  {% else %}
    {% if queued_ahead == 0 %}
      <div class="alert alert-success" role="alert">
        <strong>It's your turn!</strong> If you haven't already joined the meeting, <a href="{{ meeting.bjn_meeting_url }}">join it now!</a>
      </div>
    {% elif queued_ahead <= 5 %}
      <div class="alert alert-warning" role="alert">
        <strong>Your turn is coming up!</strong> There are <strong>{{ queued_ahead }}</strong> people ahead of you. <a href="{{ meeting.bjn_meeting_url }}">Join the meeting now</a> so you are ready when {{ owner.get_full_name }} joins.
      </div>
    {% endif %}
  <ul>
    <li>You are in line to meet with {{ owner.get_full_name }}</li>
    <li>There are {{ queued_ahead }} people in line ahead of you</li>
    <li>Meet with them here: <a href="{{ meeting.bjn_meeting_url }}">{{ meeting.bjn_meeting_url }}</a></li>
    <li>New to using BlueJeans? <a href="https://its.umich.edu/communication/videoconferencing/blue-jeans/getting-started" target="_blank">Learn about using BlueJeans at U-M</a>.</li>
  {% endif %}
</ul>

<form class="form-inline" method="post" onsubmit="submit.disabled = true; return true;" action="{% url 'meeting' owner %}">
  {% csrf_token %}
  {% if not meeting %}
  <input type="hidden" name="action" value="join" />
  <button type="submit" name="submit" class="btn btn-primary">Join the line</button>
  {% else %}
  <input type="hidden" name="action" value="leave" />
  <button type="submit" name="submit" onclick="return confirm('Are you sure?');" class="btn btn-warning">Leave the line</button>
  {% endif %}
</form>

{% if owner == request.user %}
<p class="alert alert-info col-lg">
  This is your queue, you can
  <a href="{% url 'manage' %}">manage it</a>.
</p>
{% endif %}

<hr />
<a target="_blank" href="https://documentation.its.umich.edu/node/1833">
    Documentation about using office hours
</a>

{% endblock %}

{% block scripts %}
<script type="text/javascript">
setTimeout(() => location.reload(), 10000);
</script>
{% endblock %}
